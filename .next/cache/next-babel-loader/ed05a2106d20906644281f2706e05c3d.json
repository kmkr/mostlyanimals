{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/km/git/splendid-nudibranch/client/src/photos/photo.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { PureComponent } from \"react\";\nimport PhotoText from \"./photo-text\";\nimport TransitionImage from \"../transition-image\";\n\nfunction sizes(photo) {\n  return photo.mode === \"portrait\" ? \"(min-width: 1100px) 50vw, 100vw\" : \"(min-width: 1100px) 95vw, 100vw\";\n}\n\nvar Photo = /*#__PURE__*/function (_PureComponent) {\n  _inherits(Photo, _PureComponent);\n\n  var _super = _createSuper(Photo);\n\n  function Photo(props) {\n    var _this;\n\n    _classCallCheck(this, Photo);\n\n    _this = _super.call(this);\n\n    _this.preload(props.preloadPhotos);\n\n    return _this;\n  }\n\n  _createClass(Photo, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      this.preload(nextProps.preloadPhotos);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.el) {\n        this.el.removeChild(this.el.querySelector(\"img\"));\n      }\n    }\n  }, {\n    key: \"preload\",\n    value: function preload(photos) {\n      if (this.timeout) {\n        window.clearTimeout(this.timeout);\n      }\n\n      this.timeout = setTimeout(function () {\n        photos.forEach(function (photo, index) {\n          var image = new Image();\n          image.src = photo.sizes.large.url;\n          image.setAttribute(\"srcset\", photo.srcSet);\n          image.setAttribute(\"sizes\", sizes(photo));\n          var key = \"snPreloadedPhoto\".concat(index);\n          window[key] = image;\n        });\n      }, 1000);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          next = _this$props.next,\n          previous = _this$props.previous,\n          photo = _this$props.photo;\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        \"class\": photo.mode,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          \"class\": \"photo-and-text\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            \"class\": \"photo-wrapper\",\n            ref: function ref(el) {\n              return _this2.el = el;\n            },\n            children: [previous, next, /*#__PURE__*/_jsxDEV(\"img\", {\n              alt: photo.title,\n              srcSet: photo.srcSet,\n              sizes: sizes(photo)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 53,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 50,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(PhotoText, {\n            photo: photo\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 55,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n\n  return Photo;\n}(PureComponent);\n\nexport default Photo;","map":{"version":3,"sources":["/home/km/git/splendid-nudibranch/client/src/photos/photo.js"],"names":["PureComponent","PhotoText","TransitionImage","sizes","photo","mode","Photo","props","preload","preloadPhotos","nextProps","el","removeChild","querySelector","photos","timeout","window","clearTimeout","setTimeout","forEach","index","image","Image","src","large","url","setAttribute","srcSet","key","next","previous","title"],"mappings":";;;;;;;;;;;;AAAA,SAASA,aAAT,QAA8B,OAA9B;AAEA,OAAOC,SAAP,MAAsB,cAAtB;AACA,OAAOC,eAAP,MAA4B,qBAA5B;;AAEA,SAASC,KAAT,CAAeC,KAAf,EAAsB;AACpB,SAAOA,KAAK,CAACC,IAAN,KAAe,UAAf,GACH,iCADG,GAEH,iCAFJ;AAGD;;IAEKC,K;;;;;AACJ,iBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB;;AACA,UAAKC,OAAL,CAAaD,KAAK,CAACE,aAAnB;;AAFiB;AAGlB;;;;8CAEyBC,S,EAAW;AACnC,WAAKF,OAAL,CAAaE,SAAS,CAACD,aAAvB;AACD;;;2CAEsB;AACrB,UAAI,KAAKE,EAAT,EAAa;AACX,aAAKA,EAAL,CAAQC,WAAR,CAAoB,KAAKD,EAAL,CAAQE,aAAR,CAAsB,KAAtB,CAApB;AACD;AACF;;;4BAEOC,M,EAAQ;AACd,UAAI,KAAKC,OAAT,EAAkB;AAChBC,QAAAA,MAAM,CAACC,YAAP,CAAoB,KAAKF,OAAzB;AACD;;AAED,WAAKA,OAAL,GAAeG,UAAU,CAAC,YAAM;AAC9BJ,QAAAA,MAAM,CAACK,OAAP,CAAe,UAACf,KAAD,EAAQgB,KAAR,EAAkB;AAC/B,cAAMC,KAAK,GAAG,IAAIC,KAAJ,EAAd;AACAD,UAAAA,KAAK,CAACE,GAAN,GAAYnB,KAAK,CAACD,KAAN,CAAYqB,KAAZ,CAAkBC,GAA9B;AACAJ,UAAAA,KAAK,CAACK,YAAN,CAAmB,QAAnB,EAA6BtB,KAAK,CAACuB,MAAnC;AACAN,UAAAA,KAAK,CAACK,YAAN,CAAmB,OAAnB,EAA4BvB,KAAK,CAACC,KAAD,CAAjC;AACA,cAAMwB,GAAG,6BAAsBR,KAAtB,CAAT;AACAJ,UAAAA,MAAM,CAACY,GAAD,CAAN,GAAcP,KAAd;AACD,SAPD;AAQD,OATwB,EAStB,IATsB,CAAzB;AAUD;;;6BAEQ;AAAA;;AAAA,wBAC2B,KAAKd,KADhC;AAAA,UACCsB,IADD,eACCA,IADD;AAAA,UACOC,QADP,eACOA,QADP;AAAA,UACiB1B,KADjB,eACiBA,KADjB;AAEP,0BACE;AAAK,iBAAOA,KAAK,CAACC,IAAlB;AAAA,+BACE;AAAK,mBAAM,gBAAX;AAAA,kCACE;AAAK,qBAAM,eAAX;AAA2B,YAAA,GAAG,EAAE,aAACM,EAAD;AAAA,qBAAS,MAAI,CAACA,EAAL,GAAUA,EAAnB;AAAA,aAAhC;AAAA,uBACGmB,QADH,EAEGD,IAFH,eAGE;AAAK,cAAA,GAAG,EAAEzB,KAAK,CAAC2B,KAAhB;AAAuB,cAAA,MAAM,EAAE3B,KAAK,CAACuB,MAArC;AAA6C,cAAA,KAAK,EAAExB,KAAK,CAACC,KAAD;AAAzD;AAAA;AAAA;AAAA;AAAA,oBAHF;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAME,QAAC,SAAD;AAAW,YAAA,KAAK,EAAEA;AAAlB;AAAA;AAAA;AAAA;AAAA,kBANF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cADF;AAYD;;;;EA/CiBJ,a;;AAkDpB,eAAeM,KAAf","sourcesContent":["import { PureComponent } from \"react\";\n\nimport PhotoText from \"./photo-text\";\nimport TransitionImage from \"../transition-image\";\n\nfunction sizes(photo) {\n  return photo.mode === \"portrait\"\n    ? \"(min-width: 1100px) 50vw, 100vw\"\n    : \"(min-width: 1100px) 95vw, 100vw\";\n}\n\nclass Photo extends PureComponent {\n  constructor(props) {\n    super();\n    this.preload(props.preloadPhotos);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.preload(nextProps.preloadPhotos);\n  }\n\n  componentWillUnmount() {\n    if (this.el) {\n      this.el.removeChild(this.el.querySelector(\"img\"));\n    }\n  }\n\n  preload(photos) {\n    if (this.timeout) {\n      window.clearTimeout(this.timeout);\n    }\n\n    this.timeout = setTimeout(() => {\n      photos.forEach((photo, index) => {\n        const image = new Image();\n        image.src = photo.sizes.large.url;\n        image.setAttribute(\"srcset\", photo.srcSet);\n        image.setAttribute(\"sizes\", sizes(photo));\n        const key = `snPreloadedPhoto${index}`;\n        window[key] = image;\n      });\n    }, 1000);\n  }\n\n  render() {\n    const { next, previous, photo } = this.props;\n    return (\n      <div class={photo.mode}>\n        <div class=\"photo-and-text\">\n          <div class=\"photo-wrapper\" ref={(el) => (this.el = el)}>\n            {previous}\n            {next}\n            <img alt={photo.title} srcSet={photo.srcSet} sizes={sizes(photo)} />\n          </div>\n          <PhotoText photo={photo} />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Photo;\n"]},"metadata":{},"sourceType":"module"}